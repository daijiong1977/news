âœ… DAILY AUTOMATED PIPELINE SETUP COMPLETE
===========================================

ğŸ“‹ CONFIGURATION SUMMARY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Schedule: Every day at 1:00 AM EST (6:00 AM UTC)
Next Run: Tue 2025-10-21 at 1:00 AM EST
Status: âœ… ACTIVE and ENABLED

Location: EC2 Server (18.223.121.227)
User: ec2-user
Directory: /var/www/news
Scheduler: systemd timer (RedHat/CentOS native)

ğŸš€ WHAT RUNS DAILY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Each day at 1:00 AM EST, the pipeline will:

1. âœ“ Sync latest code from GitHub
   â””â”€ Pull all updates automatically

2. âœ“ Collect articles from RSS feeds
   â””â”€ Gathers articles from last 24 hours
   â””â”€ Sources: NYT, PBS, Swimming World

3. âœ“ Process with Deepseek API
   â””â”€ Generates summaries (easy/mid/hard)
   â””â”€ Creates keywords (10 per level)
   â””â”€ Builds questions (8/10/12 per level)
   â””â”€ Collects perspectives/comments
   â””â”€ Generates background reading

4. âœ“ Insert into database
   â””â”€ Updates articles.db with all content

5. âœ“ Log results
   â””â”€ Saves detailed logs to /var/www/news/logs/

â±ï¸ TIMING DETAILS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Time Zone: EST (Eastern Standard Time)
UTC Offset: UTC-5 (during EST period)
Systemd Expression: *-*-* 06:00:00 (UTC)

Schedule Pattern: Every day at 06:00 UTC (1:00 AM EST)

Examples:
- Oct 21, 2025: 1:00 AM EST = 6:00 AM UTC âœ“
- Oct 22, 2025: 1:00 AM EST = 6:00 AM UTC âœ“
- Oct 23, 2025: 1:00 AM EST = 6:00 AM UTC âœ“
- ... (continues indefinitely)

ğŸ“Š EXPECTED DATA GROWTH
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Per day (assuming 4 articles):
- 12 article summaries
- 120 keywords
- 40-50 questions
- 36 comments/perspectives
- 12 background reading
- 8 analysis records
â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total: ~300-350 new records/day

Monthly: ~9,000-10,500 records
Yearly: ~110,000-127,500 records

ğŸ’¾ DATABASE LOCATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

File: /var/www/news/articles.db
Size: Grows ~2-3 MB per month (estimated)
Backup: Consider backing up monthly

ğŸ“ LOG LOCATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Directory: /var/www/news/logs/
Format: daily_pipeline_YYYY-MM-DD_HH-MM-SS.log
Retention: Keep indefinitely (useful for debugging)

Example log:
daily_pipeline_2025-10-21_06-00-00.log
daily_pipeline_2025-10-22_06-00-00.log

ğŸ” HOW TO MONITOR
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Check if timer is active:
$ sudo systemctl status news-pipeline.timer

View next scheduled run:
$ sudo systemctl list-timers news-pipeline.timer

View recent logs:
$ sudo journalctl -u news-pipeline.service -n 50

Monitor in real-time:
$ sudo journalctl -u news-pipeline.service -f

Check pipeline logs:
$ tail -f /var/www/news/logs/daily_pipeline_*.log

ğŸ“‚ FILES DEPLOYED
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

On EC2 (/var/www/news/):
âœ“ daily_pipeline.sh - Main automation script
âœ“ news-pipeline.service - Systemd service unit
âœ“ news-pipeline.timer - Systemd timer (deployed to /etc/systemd/system/)
âœ“ setup_cron.sh - Alternative cron setup
âœ“ DAILY_PIPELINE_SETUP.md - Full documentation
âœ“ logs/ - Directory for daily logs

ğŸ”§ SYSTEM INTEGRATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Method: systemd timer (native RedHat/CentOS)
Service Unit: /etc/systemd/system/news-pipeline.service
Timer Unit: /etc/systemd/system/news-pipeline.timer

Advantages:
âœ“ Built-in to RedHat/CentOS
âœ“ Better logging (systemd journal)
âœ“ Automatic restart on failure
âœ“ Timezone-aware
âœ“ No cron format confusion

ğŸ“‹ SCRIPTS INCLUDED
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

daily_pipeline.sh
â”œâ”€ Sources .env for API key
â”œâ”€ Git pull from GitHub
â”œâ”€ Runs data_collector.py
â”œâ”€ Runs process_all_articles.sh
â””â”€ Logs all output with timestamp

process_all_articles.sh (existing)
â”œâ”€ Loops through unprocessed articles
â”œâ”€ Calls process_one_article.py per article
â”œâ”€ Inserts results into database
â””â”€ Shows final statistics

process_one_article.py (existing)
â”œâ”€ Calls Deepseek API
â”œâ”€ Generates all content for 3 levels
â””â”€ Saves response to disk

insert_from_response.py (existing)
â”œâ”€ Reads API response
â”œâ”€ Parses all content
â””â”€ Inserts into 7 tables

data_collector.py (existing)
â”œâ”€ Hits RSS feed endpoints
â”œâ”€ Collects last 24 hours
â””â”€ Inserts new articles

âœ… VERIFICATION STATUS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Systemd Timer: âœ… LOADED AND ENABLED
Service: âœ… READY
API Key: âœ… CONFIGURED (.env file)
Database: âœ… INITIALIZED
Code: âœ… SYNCED FROM GITHUB

Next Scheduled Run:
â”œâ”€ Date: Tue Oct 21, 2025
â”œâ”€ Time: 1:00 AM EST (06:00 UTC)
â””â”€ Status: âœ… CONFIRMED IN SYSTEMD

ğŸ›‘ TO STOP PIPELINE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Disable timer:
$ sudo systemctl stop news-pipeline.timer
$ sudo systemctl disable news-pipeline.timer

Re-enable:
$ sudo systemctl enable news-pipeline.timer
$ sudo systemctl start news-pipeline.timer

ğŸ§ª MANUAL TEST
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Run pipeline manually (for testing):
$ bash /var/www/news/daily_pipeline.sh

Or via systemd:
$ sudo systemctl start news-pipeline.service

ğŸ“ TROUBLESHOOTING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Timer not running?
$ sudo systemctl status news-pipeline.timer
$ sudo journalctl -xe -u news-pipeline.timer

Service failed?
$ sudo journalctl -u news-pipeline.service -n 100

Check logs directly:
$ ls -lh /var/www/news/logs/
$ tail -100 /var/www/news/logs/daily_pipeline_*.log

API key missing?
$ cat /var/www/news/.env
$ grep DEEPSEEK_API_KEY /var/www/news/.env

Permission denied?
$ sudo chown -R ec2-user:ec2-user /var/www/news
$ sudo chmod 755 /var/www/news/daily_pipeline.sh

ğŸ“š DOCUMENTATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Full setup guide: /Users/jidai/news/DAILY_PIPELINE_SETUP.md
On server: /var/www/news/DAILY_PIPELINE_SETUP.md
On GitHub: https://github.com/daijiong1977/news/blob/main/DAILY_PIPELINE_SETUP.md

ğŸ¯ NEXT STEPS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. âœ“ Files deployed to EC2
2. âœ“ Systemd timer configured
3. âœ“ Timer enabled and started
4. â³ Wait for first scheduled run (Tue 1:00 AM EST)
5. â³ Monitor logs for successful execution

First run expected:
- **Date**: Tuesday, Oct 21, 2025
- **Time**: 1:00 AM EST
- **Log**: /var/www/news/logs/daily_pipeline_2025-10-21_06-00-00.log

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ‰ SETUP COMPLETE! 

Your news pipeline will now automatically:
- Collect fresh articles every day
- Analyze them with AI (Deepseek)
- Build comprehensive content library
- Update your database

All running hands-free at 1:00 AM EST daily! âœ¨

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
